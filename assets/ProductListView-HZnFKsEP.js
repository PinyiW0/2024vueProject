import{_ as p,d as h,o as d,c as a,a as t,w as r,F as b,r as _,b as f,v as g,e as v,f as y,t as n}from"./index-kdvPWLw3.js";var P={VITE_URL:"https://ec-course-api.hexschool.io/",VITE_PATH:"pinyi9",BASE_URL:"/2024vueProject/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:i,VITE_PATH:u}=P,k={data(){return{products:[],isNew:!1,tempProduct:{},productModal:null,delProductModal:null}},methods:{checkAdmin(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)leleToken\s*=\s*([^;]*).*$)|^.*$/,"$1");h.defaults.headers.common.Authorization=e,this.axios.post(`${i}V2/api/user/check`).then(o=>{this.getProducts()}).catch(o=>{alert(o.response.data.message),this.$router.push({name:"LoginView"})})},getProducts(){this.axios.get(`${i}V2/api/${u}/admin/products`).then(e=>{this.products=e.data.products}).catch(e=>{alert(e.response.data.message)})},openProduct(e){this.tempProduct=e},openModal(e,o){e==="new"?(this.tempProduct={},this.isNew=!0,this.productModal.show()):e==="edit"?(this.tempProduct={...o},this.isNew=!1,this.productModal.show()):e==="delete"&&(this.tempProduct={...o},this.delProductModal.show())},updateProduct(){console.log(this.tempProduct.id),this.isNew?this.axios.post(`${i}V2/api/${u}/admin/product`,this.tempProduct).then(e=>{alert("產品新增成功"),this.productModal.hide(),this.getProducts()}).catch(e=>{alert(e.response.data.message)}):this.axios.put(`${i}V2/api/${u}/admin/product/${this.tempProduct.id}`,this.tempProduct).then(e=>{alert("產品更新成功"),this.productModal.hide(),this.getData()}).catch(e=>{alert(e.response.data.message)})},delProduct(){this.axios.delete(`${i}V2/api/${u}/admin/product/${this.tempProduct.id}`).then(e=>{alert(e.data.meassage),this.delProductModal.hide(),this.getData()}).catch(e=>{alert(e.response.data.message)})},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")}},mounted(){this.checkAdmin(),this.productModal=new this.$bs.Modal(document.getElementById("productModal"),{keyboard:!1,backdrop:"static"}),this.delProductModal=new this.$bs.Modal(document.getElementById("delProductModal"),{keyboard:!1,backdrop:"static"})}},x={id:"app"},M={class:"container"},w={class:"text-end mt-4"},V={class:"table table-hover mt-4"},C=t("thead",null,[t("tr",null,[t("th",{width:"120"}," 分類 "),t("th",null,"產品名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"100"}," 是否啟用 "),t("th",{width:"120"}," 編輯 ")])],-1),U={class:"text-end"},I={class:"text-end"},L={key:0,class:"text-success"},E={key:1,class:"text-danger"},$={class:"btn-group"},T=["onClick"],D=["onClick"],N={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},A={class:"modal-dialog modal-xl"},B={class:"modal-content border-0"},R=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"productModalLabel",class:"modal-title"},[t("span",null,"新增產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),S={class:"modal-body"},F={class:"row"},H={class:"col-sm-4"},O={class:"mb-2"},j={class:"mb-3"},z=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),q=["src"],G={key:0},J=t("div",{class:"col-sm-8"},[t("div",{class:"mb-3"},[t("label",{for:"title",class:"form-label"},"標題"),t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題"})]),t("div",{class:"row"},[t("div",{class:"mb-3 col-md-6"},[t("label",{for:"category",class:"form-label"},"分類"),t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類"})]),t("div",{class:"mb-3 col-md-6"},[t("label",{for:"price",class:"form-label"},"單位"),t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位"})])]),t("div",{class:"row"},[t("div",{class:"mb-3 col-md-6"},[t("label",{for:"origin_price",class:"form-label"},"原價"),t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"})]),t("div",{class:"mb-3 col-md-6"},[t("label",{for:"price",class:"form-label"},"售價"),t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"})])]),t("hr"),t("div",{class:"mb-3"},[t("label",{for:"description",class:"form-label"},"產品描述"),t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述"},`
                    `)]),t("div",{class:"mb-3"},[t("label",{for:"content",class:"form-label"},"說明內容"),t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容"},`
                    `)]),t("div",{class:"mb-3"},[t("div",{class:"form-check"},[t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0}),t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用")])])],-1),K={class:"modal-footer"},Q=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),W={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},X={class:"modal-dialog"},Y={class:"modal-content border-0"},Z=y('<div class="modal-header bg-danger text-white"><h5 id="delProductModalLabel" class="modal-title"><span>刪除產品</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"> 是否刪除 <strong class="text-danger"></strong> 商品(刪除後將無法恢復)。 </div>',2),tt={class:"modal-footer"},et=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function st(e,o,ot,lt,c,l){return d(),a("main",null,[t("div",x,[t("div",M,[t("div",w,[t("button",{class:"btn btn-primary",onClick:o[0]||(o[0]=r(s=>l.openModal("new"),["prevent"]))}," 建立新的產品 ")]),t("table",V,[C,t("tbody",null,[(d(!0),a(b,null,_(e.productList,s=>(d(),a("tr",{key:s.id},[t("td",null,n(s.category),1),t("td",null,n(s.title),1),t("td",U,n(s.origin_price),1),t("td",I,n(s.price),1),t("td",null,[s.is_enabled?(d(),a("span",L,"啟用")):(d(),a("span",E,"未啟用"))]),t("td",null,[t("div",$,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:r(m=>l.openModal("edit",s),["prevent"])}," 編輯 ",8,T),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:r(m=>l.openModal("delete",s),["prevent"])}," 刪除 ",8,D)])])]))),128))])])]),t("div",N,[t("div",A,[t("div",B,[R,t("div",S,[t("div",F,[t("div",H,[t("div",O,[t("div",j,[z,f(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結",id:"imageUrl","onUpdate:modelValue":o[1]||(o[1]=s=>c.tempProduct.imageUrl=s)},null,512),[[g,c.tempProduct.imageUrl]])]),t("img",{class:"img-fluid",src:c.tempProduct.imageUrl,alt:""},null,8,q)]),t("div",null,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:o[2]||(o[2]=r((...s)=>l.createImages&&l.createImages(...s),["prevent"]))}," 新增圖片 ")]),c.tempProduct.imagesUrl?(d(),a("div",G,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:o[3]||(o[3]=(...s)=>l.createImages&&l.createImages(...s))}," 刪除圖片 ")])):v("",!0)]),J])]),t("div",K,[Q,t("button",{type:"button",class:"btn btn-primary",onClick:o[4]||(o[4]=(...s)=>l.updateProduct&&l.updateProduct(...s))}," 確認 ")])])])],512),t("div",W,[t("div",X,[t("div",Y,[Z,t("div",tt,[et,t("button",{type:"button",class:"btn btn-danger",onClick:o[5]||(o[5]=(...s)=>l.delProduct&&l.delProduct(...s))}," 確認刪除 ")])])])],512)])])}const at=p(k,[["render",st]]);export{at as default};
